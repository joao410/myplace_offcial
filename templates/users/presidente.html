{% extends 'base.html' %}
{% load static %}


{% block content %}

<svg class="Linha_1" viewBox="0 0 1482 1">
  <path id="Linha_1" d="M 0 0 L 1482 0">
  </path>
</svg>
<main role="main"  class="col-md-8 m-sm-auto col-lg-8 col-md-6  "  >
     
  <div style="top:250px;"  class="container  ">
  
    <div style="top: -170px;" id="Atendimento_ba_">
      <span>Usuários</span>
    </div>

  <a href="{% url 'add_usuarios' %}">
  <div class="Retngulo_58_ text-white fs-5 fw-bold d-flex justify-content-center pt-2">
		<span>Cadastrar Usuário</span>
  </div>
  </a>
 
		

  <div class="Retngulo_56_ text-white border border-dark d-flex justify-content-center fs-5 fw-bold pt-2 ">
		<span>Usuários</span>
  </div>
 <!--
	<div class="Retngulo_57_ border border-dark d-flex justify-content-center text-dark fs-5 fw-bold pt-2">
		<span>Permissões</span>
  </div>
</a>-->
  
		
	

		

 <div class="container d-flex flex-nowrap  N_21_  ">
    <form method="GET">
      {% csrf_token %}
    <div class="row">
    <div style="left: 0%;" class="col-2" >	
      {{filtro.form.name}}
    </div>

    <div style="left: 14%;" class="col-2 " >
      {{filtro.form.departamento}}
    </div>

    <div style="left: 100%;" class="col-2 " >
      <span><button class="btn btn-primary" type="submit" style="border-radius: 20px; box-shadow:0 8px 6px -6px rgb(161, 161, 161)" >Filtrar</button></span>
    </div>  
      </div>  
  </form>
</div>


<form method="POST" action="{% url 'perfisuser' %}">
  {% csrf_token %}
  <table id="example" class="table table-striped table-bordered  N_22" style="width:100%">
      <thead>
        <tr>
        <th><span>Nome</span></th>
        <th><span>Departamento</span></th>
        <th><span>Ramal</span></th>  
        <th><span>Cel.Corporativo</span></th>
        <th><span>E-mail</span></th>
        <th><span>Skype</span></th>
        <th></th>

        </tr>
      </thead>
    <tbody style="height: 500px; overflow-y: hidden;"  >      
        
      {% for users in users  %}
      <tr>
        <td>{{users.codigo.nome}}</td>
        <td>{{users.trabalho.departamento}}</td>
        <td>{{users.ramal}}</td>
        <td>{{users.tel}}</td>
        <td>{{users.emailCorporativo}}</span></td>
        <td>{{users.skype}}</td>
        <td>		
        <button type="submit" value="{{users.id}}" class="bg-transparent"  name="perfil">	
            <img  class="mt-3 " src="{% static 'img/add-button1.png' %}" srcset="{% static 'img/add-button1.png' %} 1x, {% static 'img/add-button1@2x.png' %} 2x">
        </button>
        </td>
      </tr>
      {% endfor %}
  
    </tbody>
 
 </table>
</form>
<input type="button" id="btnExport" value=" Exportar excel " />
     

    </div>

  </main>
  {% block js %}
  <script>
   function exportTableToExcel(tableID, filename = ''){
    var downloadLink;
    var dataType = 'application/vnd.ms-excel';
    var tableSelect = document.getElementById(tableID);
    var tableHTML = tableSelect.outerHTML.replace(/ /g, '%20');
    
    // Specify file name
    filename = filename?filename+'.xls':'excel_data.xls';
    
    // Create download link element
    downloadLink = document.createElement("a");
    
    document.body.appendChild(downloadLink);
    
    if(navigator.msSaveOrOpenBlob){
        var blob = new Blob(['\ufeff', tableHTML], {
            type: dataType
        });
        navigator.msSaveOrOpenBlob( blob, filename);
    }else{
        // Create a link to the file
        downloadLink.href = 'data:' + dataType + ', ' + tableHTML;
    
        // Setting the file name
        downloadLink.download = filename;
        
        //triggering the function
        downloadLink.click();
    }
}
  </script>

<script>
  $(document).ready(function() {
	  $('#example').DataTable({
  "scrollY":"800px",
  "order": [[ 0, "desc" ]],
  "language": {
  "sSearch": "Buscar:",
  "sInfo": "Chanados de _START_ a _END_ (Total _MAX_)",
  "sInfoEmpty": "0 chamados",
  "sInfoFiltered": "(filtrado de um total de _MAX_ chamados)",
  "sLengthMenu": "Mostrar _MENU_ chamados",
  "sZeroRecords": "Nenhum chamado encontrado",
  "sEmptyTable": "Zero chamados",
  "paginate": {
  "previous": "Anterior",
  "next": "Próxima"
  },
  

  
}
});
  } );
	</script>
    
  {% endblock js %}
{% endblock content %}  